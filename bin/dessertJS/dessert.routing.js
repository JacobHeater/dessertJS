!function(){"use strict";define(["./dessert.common"],function(t){function e(t){var e="";return t&&t.length&&t.length>0&&(e+="/:",e+=t.map(function(t){return t.key.concat("=").concat(escape(t.value))}).reduce(function(t,e){return t.concat("&").concat(e)})),e}function n(t){return t.replace(/[#]+/g,"")}function r(t){var e=/(#\/[\w\d\/&=:]+)/gi;return e.test(t)}function o(t){return(t.split("#")[1]||"").indexOf(":")>-1}var c="undefined"!=typeof window?window:{location:{href:"",hash:""},addEventListener:t.utils.noop},a=c.location,i={hasRoute:function(t){var e=t||a.href;return r(e)},setRoute:function(t,o){var c=a.href;t===this.CURRENT&&(t=this.getRoute()),o&&(t+=e(o)),r(a.href)&&(c=a.href.split("#")[0]),a.href=n(c).concat("#").concat(t)},getRoute:function(t){var e=t||a.href,n=e.split("#")[1]||"",r=n.split(":")[0]||"",o=/\/$/gim;return r.match(o)&&(r=r.replace(o,"")),r},getParams:function(t){var e=/[a-z]+:\/\//gim,n=t||a.href;e.test(n)&&(n=n.replace(a.protocol.concat("//").concat(a.host).concat("/"),""));var r=[],c="";return o(n)&&(c=n.split(":")[1],r=c.split("&"),r=r.map(function(t){var e=t.split("=");return{key:e[0]||"",value:unescape(e[1]||"")}})),r},onRouteChange:function(t){var e=this;c.addEventListener("hashchange",function(){e.hasRoute()?t():c.location.href=document.referrer.trim()||c.location.href})}};return t.utils.addReadOnlyProperty(i,"CURRENT","CURRENT"),i})}();